!function(e){function f(c,d){return c+".touchspin_"+d}function g(a,b){return e.map(a,function(c){return f(c,b)})}var h=0;e.fn.TouchSpin=function(a){if("destroy"===a){return void this.each(function(){var i=e(this),j=i.data();e(document).off(g(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],j.spinnerid).join(" "))})}var c={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},d={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function S(){if(!Z.data("alreadyinitialized")){if(Z.data("alreadyinitialized",!0),h+=1,Z.data("spinnerid",h),!Z.is("input")){return void console.log("Must be an input.")}Y(),U(),an(),ae(),ai(),aj(),ak(),al(),P.input.css("display","block")}}function U(){""!==N.initval&&""===Z.val()&&Z.val(N.initval)}function W(i){ac(i),an();var j=P.input.val();""!==j&&(j=Number(P.input.val()),P.input.val(j.toFixed(N.decimals)))}function Y(){N=e.extend({},c,ab,aa(),a)}function aa(){var i={};return e.each(d,function(j,k){var l="bts-"+k;Z.is("[data-"+l+"]")&&(i[j]=Z.data(l))}),i}function ac(i){N=e.extend({},N,i),i.postfix&&Z.parent().find(".bootstrap-touchspin-postfix").text(i.postfix),i.prefix&&Z.parent().find(".bootstrap-touchspin-prefix").text(i.prefix)}function ae(){var i=Z.val(),j=Z.parent();""!==i&&(i=Number(i).toFixed(N.decimals)),Z.data("initvalue",i).val(i),Z.addClass("form-control"),j.hasClass("input-group")?ag(j):ah()}function ag(i){i.addClass("bootstrap-touchspin");var j,k,l=Z.prev(),m=Z.next(),n='<span class="input-group-addon bootstrap-touchspin-prefix">'+N.prefix+"</span>",o='<span class="input-group-addon bootstrap-touchspin-postfix">'+N.postfix+"</span>";l.hasClass("input-group-btn")?(j='<button class="'+N.buttondown_class+' bootstrap-touchspin-down" type="button">'+N.buttondown_txt+"</button>",l.append(j)):(j='<span class="input-group-btn"><button class="'+N.buttondown_class+' bootstrap-touchspin-down" type="button">'+N.buttondown_txt+"</button></span>",e(j).insertBefore(Z)),m.hasClass("input-group-btn")?(k='<button class="'+N.buttonup_class+' bootstrap-touchspin-up" type="button">'+N.buttonup_txt+"</button>",m.prepend(k)):(k='<span class="input-group-btn"><button class="'+N.buttonup_class+' bootstrap-touchspin-up" type="button">'+N.buttonup_txt+"</button></span>",e(k).insertAfter(Z)),e(n).insertBefore(Z),e(o).insertAfter(Z),O=i}function ah(){var i;i=N.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+N.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+N.postfix+'</span><span class="input-group-btn-vertical"><button class="'+N.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+N.verticalupclass+'"></i></button><button class="'+N.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+N.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+N.buttondown_class+' bootstrap-touchspin-down" type="button">'+N.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+N.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+N.postfix+'</span><span class="input-group-btn"><button class="'+N.buttonup_class+' bootstrap-touchspin-up" type="button">'+N.buttonup_txt+"</button></span></div>",O=e(i).insertBefore(Z),e(".bootstrap-touchspin-prefix",O).after(Z),Z.hasClass("input-sm")?O.addClass("input-group-sm"):Z.hasClass("input-lg")&&O.addClass("input-group-lg")}function ai(){P={down:e(".bootstrap-touchspin-down",O),up:e(".bootstrap-touchspin-up",O),input:e("input",O),prefix:e(".bootstrap-touchspin-prefix",O).addClass(N.prefix_extraclass),postfix:e(".bootstrap-touchspin-postfix",O).addClass(N.postfix_extraclass)}}function aj(){""===N.prefix&&P.prefix.hide(),""===N.postfix&&P.postfix.hide()}function ak(){Z.on("keydown",function(i){var j=i.keyCode||i.which;38===j?("up"!==af&&(ap(),at()),i.preventDefault()):40===j&&("down"!==af&&(aq(),ar()),i.preventDefault())}),Z.on("keyup",function(i){var j=i.keyCode||i.which;38===j?b():40===j&&b()}),Z.on("blur",function(){an()}),P.down.on("keydown",function(i){var j=i.keyCode||i.which;(32===j||13===j)&&("down"!==af&&(aq(),ar()),i.preventDefault())}),P.down.on("keyup",function(i){var j=i.keyCode||i.which;(32===j||13===j)&&b()}),P.up.on("keydown",function(i){var j=i.keyCode||i.which;(32===j||13===j)&&("up"!==af&&(ap(),at()),i.preventDefault())}),P.up.on("keyup",function(i){var j=i.keyCode||i.which;(32===j||13===j)&&b()}),P.down.on("mousedown.touchspin",function(i){P.down.off("touchstart.touchspin"),Z.is(":disabled")||(aq(),ar(),i.preventDefault(),i.stopPropagation())}),P.down.on("touchstart.touchspin",function(i){P.down.off("mousedown.touchspin"),Z.is(":disabled")||(aq(),ar(),i.preventDefault(),i.stopPropagation())}),P.up.on("mousedown.touchspin",function(i){P.up.off("touchstart.touchspin"),Z.is(":disabled")||(ap(),at(),i.preventDefault(),i.stopPropagation())}),P.up.on("touchstart.touchspin",function(i){P.up.off("mousedown.touchspin"),Z.is(":disabled")||(ap(),at(),i.preventDefault(),i.stopPropagation())}),P.up.on("mouseout touchleave touchend touchcancel",function(i){af&&(i.stopPropagation(),b())}),P.down.on("mouseout touchleave touchend touchcancel",function(i){af&&(i.stopPropagation(),b())}),P.down.on("mousemove touchmove",function(i){af&&(i.stopPropagation(),i.preventDefault())}),P.up.on("mousemove touchmove",function(i){af&&(i.stopPropagation(),i.preventDefault())}),e(document).on(g(["mouseup","touchend","touchcancel"],h).join(" "),function(i){af&&(i.preventDefault(),b())}),e(document).on(g(["mousemove","touchmove","scroll","scrollstart"],h).join(" "),function(i){af&&(i.preventDefault(),b())}),Z.on("mousewheel DOMMouseScroll",function(i){if(N.mousewheel&&Z.is(":focus")){var j=i.originalEvent.wheelDelta||-i.originalEvent.deltaY||-i.originalEvent.detail;i.stopPropagation(),i.preventDefault(),0>j?aq():ap()}})}function al(){Z.on("touchspin.uponce",function(){b(),ap()}),Z.on("touchspin.downonce",function(){b(),aq()}),Z.on("touchspin.startupspin",function(){at()}),Z.on("touchspin.startdownspin",function(){ar()}),Z.on("touchspin.stopspin",function(){b()}),Z.on("touchspin.updatesettings",function(i,j){W(j)})}function am(i){switch(N.forcestepdivisibility){case"round":return(Math.round(i/N.step)*N.step).toFixed(N.decimals);case"floor":return(Math.floor(i/N.step)*N.step).toFixed(N.decimals);case"ceil":return(Math.ceil(i/N.step)*N.step).toFixed(N.decimals);default:return i}}function an(){var i,j,k;return i=Z.val(),""===i?void (""!==N.replacementval&&(Z.val(N.replacementval),Z.trigger("change"))):void (N.decimals>0&&"."===i||(j=parseFloat(i),isNaN(j)&&(j=""!==N.replacementval?N.replacementval:0),k=j,j.toString()!==i&&(k=j),j<N.min&&(k=N.min),j>N.max&&(k=N.max),k=am(k),Number(i).toString()!==k.toString()&&(Z.val(k),Z.trigger("change"))))}function ao(){if(N.booster){var i=Math.pow(2,Math.floor(ad/N.boostat))*N.step;return N.maxboostedstep&&i>N.maxboostedstep&&(i=N.maxboostedstep,Q=Math.round(Q/i)*i),Math.max(N.step,i)}return N.step}function ap(){an(),Q=parseFloat(P.input.val()),isNaN(Q)&&(Q=0);var i=Q,j=ao();Q+=j,Q>N.max&&(Q=N.max,Z.trigger("touchspin.on.max"),b()),P.input.val(Number(Q).toFixed(N.decimals)),i!==Q&&Z.trigger("change")}function aq(){an(),Q=parseFloat(P.input.val()),isNaN(Q)&&(Q=0);var i=Q,j=ao();Q-=j,Q<N.min&&(Q=N.min,Z.trigger("touchspin.on.min"),b()),P.input.val(Q.toFixed(N.decimals)),i!==Q&&Z.trigger("change")}function ar(){b(),ad=0,af="down",Z.trigger("touchspin.on.startspin"),Z.trigger("touchspin.on.startdownspin"),V=setTimeout(function(){R=setInterval(function(){ad++,aq()},N.stepinterval)},N.stepintervaldelay)}function at(){b(),ad=0,af="up",Z.trigger("touchspin.on.startspin"),Z.trigger("touchspin.on.startupspin"),X=setTimeout(function(){T=setInterval(function(){ad++,ap()},N.stepinterval)},N.stepintervaldelay)}function b(){switch(clearTimeout(V),clearTimeout(X),clearInterval(R),clearInterval(T),af){case"up":Z.trigger("touchspin.on.stopupspin"),Z.trigger("touchspin.on.stopspin");break;case"down":Z.trigger("touchspin.on.stopdownspin"),Z.trigger("touchspin.on.stopspin")}ad=0,af=!1}var N,O,P,Q,R,T,V,X,Z=e(this),ab=Z.data(),ad=0,af=!1;S()})}}(jQuery);