/* Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.8
 *
 */
(function(a){a.fn.extend({slimScroll:function(c){var b=a.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:0.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},c);this.each(function(){function J(k){if(H){k=k||window.event;var h=0;k.wheelDelta&&(h=-k.wheelDelta/120);k.detail&&(h=k.detail/3);a(k.target||k.srcTarget||k.srcElement).closest("."+b.wrapperClass).is(e.parent())&&E(h,!0);k.preventDefault&&!o&&k.preventDefault();o||(k.returnValue=!1)}}function E(h,m,k){o=!1;var l=e.outerHeight()-g.outerHeight();m&&(m=parseInt(g.css("top"))+h*parseInt(b.wheelStep)/100*g.outerHeight(),m=Math.min(Math.max(m,0),l),m=0<h?Math.ceil(m):Math.floor(m),g.css({top:m+"px"}));s=parseInt(g.css("top"))/(e.outerHeight()-g.outerHeight());m=s*(e[0].scrollHeight-e.outerHeight());k&&(m=h,h=m/e[0].scrollHeight*e.outerHeight(),h=Math.min(Math.max(h,0),l),g.css({top:h+"px"}));e.scrollTop(m);e.trigger("slimscrolling",~~m);K();F()}function L(){I=Math.max(e.outerHeight()/e[0].scrollHeight*e.outerHeight(),30);g.css({height:I+"px"});var h=I==e.outerHeight()?"none":"block";g.css({display:h})}function K(){L();clearTimeout(f);s==~~s?(o=b.allowPageScroll,i!=s&&e.trigger("slimscroll",0==~~s?"top":"bottom")):o=!1;i=s;I>=e.outerHeight()?o=!0:(g.stop(!0,!0).fadeIn("fast"),b.railVisible&&D.stop(!0,!0).fadeIn("fast"))}function F(){b.alwaysVisible||(f=setTimeout(function(){b.disableFadeOut&&H||M||N||(g.fadeOut("slow"),D.fadeOut("slow"))},1000))}var H,M,N,f,d,I,s,i,o=!1,e=a(this);if(e.parent().hasClass(b.wrapperClass)){var G=e.scrollTop(),g=e.siblings("."+b.barClass),D=e.siblings("."+b.railClass);L();if(a.isPlainObject(c)){if("height" in c&&"auto"==c.height){e.parent().css("height","auto");e.css("height","auto");var j=e.parent().parent().height();e.parent().css("height",j);e.css("height",j)}else{"height" in c&&(j=c.height,e.parent().css("height",j),e.css("height",j))}if("scrollTo" in c){G=parseInt(b.scrollTo)}else{if("scrollBy" in c){G+=parseInt(b.scrollBy)}else{if("destroy" in c){g.remove();D.remove();e.unwrap();return}}}E(G,!1,!0)}}else{if(!(a.isPlainObject(c)&&"destroy" in c)){b.height="auto"==b.height?e.parent().height():b.height;G=a("<div></div>").addClass(b.wrapperClass).css({position:"relative",overflow:"hidden",width:b.width,height:b.height});e.css({overflow:"hidden",width:b.width,height:b.height});var D=a("<div></div>").addClass(b.railClass).css({width:b.size,height:"100%",position:"absolute",top:0,display:b.alwaysVisible&&b.railVisible?"block":"none","border-radius":b.railBorderRadius,background:b.railColor,opacity:b.railOpacity,zIndex:90}),g=a("<div></div>").addClass(b.barClass).css({background:b.color,width:b.size,position:"absolute",top:0,opacity:b.opacity,display:b.alwaysVisible?"block":"none","border-radius":b.borderRadius,BorderRadius:b.borderRadius,MozBorderRadius:b.borderRadius,WebkitBorderRadius:b.borderRadius,zIndex:99}),j="right"==b.position?{right:b.distance}:{left:b.distance};D.css(j);g.css(j);e.wrap(G);e.parent().append(g);e.parent().append(D);b.railDraggable&&g.bind("mousedown",function(h){var k=a(document);N=!0;t=parseFloat(g.css("top"));pageY=h.pageY;k.bind("mousemove.slimscroll",function(l){currTop=t+l.pageY-pageY;g.css("top",currTop);E(0,g.position().top,!1)});k.bind("mouseup.slimscroll",function(l){N=!1;F();k.unbind(".slimscroll")});return !1}).bind("selectstart.slimscroll",function(h){h.stopPropagation();h.preventDefault();return !1});D.hover(function(){K()},function(){F()});g.hover(function(){M=!0},function(){M=!1});e.hover(function(){H=!0;K();F()},function(){H=!1;F()});e.bind("touchstart",function(h,k){h.originalEvent.touches.length&&(d=h.originalEvent.touches[0].pageY)});e.bind("touchmove",function(h){o||h.originalEvent.preventDefault();h.originalEvent.touches.length&&(E((d-h.originalEvent.touches[0].pageY)/b.touchScrollStep,!0),d=h.originalEvent.touches[0].pageY)});L();"bottom"===b.start?(g.css({top:e.outerHeight()-g.outerHeight()}),E(0,!0)):"top"!==b.start&&(E(a(b.start).position().top,null,!0),b.alwaysVisible||g.hide());window.addEventListener?(this.addEventListener("DOMMouseScroll",J,!1),this.addEventListener("mousewheel",J,!1)):document.attachEvent("onmousewheel",J)}}});return this}});a.fn.extend({slimscroll:a.fn.slimScroll})})(jQuery);